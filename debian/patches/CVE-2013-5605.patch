Description: CVE-2013-5605: Null_Cipher() does not respect maxOutputLen
Origin: upstream, https://hg.mozilla.org/projects/nss/raw-rev/e79a09364b5e
Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=934016
Bug-RedHat: https://bugzilla.redhat.com/show_bug.cgi?id=1030807
Forwarded: not-needed
Author: Ryan Sleevi <ryan.sleevi@gmail.com>
Last-Update: 2013-11-23
Applied-Upstream: 3.14.5, 3.15.3

--- a/mozilla/security/nss/lib/ssl/ssl3con.c
+++ b/mozilla/security/nss/lib/ssl/ssl3con.c
@@ -781,6 +781,11 @@
 Null_Cipher(void *ctx, unsigned char *output, int *outputLen, int maxOutputLen,
 	    const unsigned char *input, int inputLen)
 {
+    if (inputLen > maxOutputLen) {
+        *outputLen = 0;  /* Match PK11_CipherOp in setting outputLen */
+        PORT_SetError(SEC_ERROR_OUTPUT_LEN);
+        return SECFailure;
+    }
     *outputLen = inputLen;
     if (input != output)
 	PORT_Memcpy(output, input, inputLen);
