--- nss-wheezy.git.orig/nss/lib/softoken/pkcs11c.c
+++ nss-wheezy.git/nss/lib/softoken/pkcs11c.c
@@ -1278,7 +1278,7 @@
 	    }
 	    /* encrypt the current padded data */
     	    rv = (*context->update)(context->cipherInfo, pEncryptedPart, 
-		&padoutlen, context->blockSize, context->padBuf,
+		&padoutlen, maxout, context->padBuf,
 							context->blockSize);
 	    if (rv != SECSuccess) {
 		return sftk_MapCryptError(PORT_GetError());
